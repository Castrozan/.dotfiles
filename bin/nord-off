#!/usr/bin/env bash
# Script to disconnect from NordVPN, handling Tailscale restart
# Disconnects wgnord, then restarts Tailscale if service is enabled

# Check if running as root
if [ "$EUID" -ne 0 ]; then
    echo "This script must be run as root (with sudo)"
    exit 1
fi

# Disconnect from NordVPN
echo "Disconnecting from NordVPN..."
wgnord d

# Restart Tailscale if service exists and is enabled
if systemctl list-unit-files | grep -q tailscaled.service 2>/dev/null; then
    if systemctl is-enabled --quiet tailscaled 2>/dev/null; then
        echo "Restarting Tailscale service..."
        systemctl start tailscaled
        sleep 2
        echo "Tailscale restarted"
    fi
fi

echo "Disconnected from NordVPN"
